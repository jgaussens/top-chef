JSEPackage("ViaMichelin.Api.UI.Core.OverlaysManager"),ViaMichelin.Api.UI.Core.OverlaysManager={overlays:[],zIndexs:100,removedIframes:[],registerOverlay:function(e,a){this.overlays.push([e,a]),this.hideSelectBoxes(document)},unregisterOverlay:function(e,a){for(var s=this.overlays.length-1;s>=0;s--)if(this.overlays[s][0]===e&&this.overlays[s][1]===a){this.overlays.splice(s,1);break}0===this.overlays.length?this.showSelectBoxes():(this.overlays[this.overlays.length-1][0].rectangle&&this.overlays[this.overlays.length-1][0].rectangle.HTMLElement&&(this.overlays[this.overlays.length-1][0].rectangle.HTMLElement.getElementsByTagName("iframe")[0].style.visibility="visible",this.overlays[this.overlays.length-1][0].rectangle.startRefresh&&this.overlays[this.overlays.length-1][0].rectangle.startRefresh()),this.showSelectBoxes(this.overlays[this.overlays.length-1][0].HTMLElement))},hideSelectBoxes:function(e){("undefined"==typeof e||null==e)&&(e=document);var a,s,t;if(navigator.isIE6)for(a=0;a<e.getElementsByTagName("SELECT").length;a++)e.getElementsByTagName("SELECT")[a].wasHidden="hidden"==e.getElementsByTagName("SELECT")[a].style.visibility?!0:!1,e.getElementsByTagName("SELECT")[a].style.visibility="hidden";for(s=0;s<frames.length;s++){t=frames[s];try{var i=t.document.getElementsByTagName("SELECT");for(a=0;a<i.length;a++)i[a].style.visibility="hidden"}catch(n){}}for(s=0;s<e.getElementsByTagName("IFRAME").length;s++){t=e.getElementsByTagName("IFRAME")[s];try{var l=t.expando;l=l?t.expando.datasheetComponent:null,null!=l&&l==this.overlays[this.overlays.length-1][0]||-1==t.src.indexOf("GdH")&&-1==t.name.indexOf("Gdh")||($isDefined(t.expando)&&$isDefined(t.expando.hideAds)&&t.expando.hideAds(),t.expando&&t.expando.stopRefresh&&t.expando.stopRefresh())}catch(n){}}},hideAds:function(e){e||(e=document);for(var a=0;a<e.getElementsByTagName("IFRAME").length;a++){var s=e.getElementsByTagName("IFRAME")[a].expando;s=s?e.getElementsByTagName("IFRAME")[a].expando.datasheetComponent:null,null!=s&&s==this.overlays[this.overlays.length-1][0]||-1==e.getElementsByTagName("IFRAME")[a].src.indexOf("GdH")&&-1==e.getElementsByTagName("IFRAME")[a].name.indexOf("Gdh")||(e.getElementsByTagName("IFRAME")[a].expando&&e.getElementsByTagName("IFRAME")[a].expando.hideAds&&e.getElementsByTagName("IFRAME")[a].expando.hideAds(),e.getElementsByTagName("IFRAME")[a].expando&&e.getElementsByTagName("IFRAME")[a].expando.stopRefresh&&e.getElementsByTagName("IFRAME")[a].expando.stopRefresh())}},showAds:function(e){e||(e=document);for(var a=0;a<e.getElementsByTagName("IFRAME").length;a++){var s=e.getElementsByTagName("IFRAME")[a];s.expando&&s.expando.showAds&&s.expando.showAds(),s.expando&&s.expando.startRefresh&&s.expando.startRefresh()}},showSelectBoxes:function(e,a){e||(e=document);var s,t,i;if(navigator.isIE6)for(s=0;s<e.getElementsByTagName("SELECT").length;s++)"hidden"==e.getElementsByTagName("SELECT")[s].style.visibility&&(e.getElementsByTagName("SELECT")[s].style.visibility="visible");for(t=0;t<frames.length;t++)try{i=frames[t];var n=i.document.getElementsByTagName("SELECT");for(s=0;s<n.length;s++)n[s].style.visibility="visible"}catch(l){}for(t=0;t<e.getElementsByTagName("IFRAME").length;t++){i=e.getElementsByTagName("IFRAME")[t];try{$isDefined(i.expando)&&$isDefined(i.expando.showAds)&&i.expando.showAds(),$isDefined(i.expando)&&$isDefined(i.expando.startRefresh)&&i.expando.startRefresh(),!a&&$isDefined(i.expando)&&$isDefined(i.expando.showFlash)&&i.expando.showFlash()}catch(l){}}this.removedIframes=[]},closeOverlays:function(){for(var e=this.overlays.length,a=e-1;a>=0;a--)this.overlays[a][1].call(this.overlays[a][0]);this.overlays=[]},_resizeOverlays:function(){if(ViaMichelin&&ViaMichelin.Api&&ViaMichelin.Api.UI&&ViaMichelin.Api.UI.Core&&ViaMichelin.Api.UI.Core.OverlaysManager.overlays)for(var e=0;e<ViaMichelin.Api.UI.Core.OverlaysManager.overlays.length;e++)ViaMichelin.Api.UI.Core.OverlaysManager.overlays[e][0].resize&&ViaMichelin.Api.UI.Core.OverlaysManager.overlays[e][0].resize()}},navigator.isIE?window.attachEvent("onresize",ViaMichelin.Api.UI.Core.OverlaysManager._resizeOverlays):window.addEventListener("resize",ViaMichelin.Api.UI.Core.OverlaysManager._resizeOverlays,!1);