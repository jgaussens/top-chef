JSEPackage("ViaMichelin.Api.Util.Drawing.VML"),ViaMichelin.Api.Util.Drawing.VML={_createContainerVML:function(){var t;return t=document.createElement("div"),t.style.width=this._width+"px",t.style.height=this._height+"",$isDefined(this._options)&&$isDefined(this._options.className)&&(t.className=this._options.className),t},createVML:function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_drawCircleVML:function(t,e,i,s){var a=this.createVML("oval");a.style.position="absolute",a.style.left=t[0]-e+"px",a.style.top=t[1]-e+"px",a.style.width=2*e+"px",a.style.height=2*e+"px";var r=this.createVML("fill");r.setAttribute("color",i.fill),r.setAttribute("opacity",i["fill-opacity"]),r.color=i.fill,r.opacity=i["fill-opacity"],a.appendChild(r);var o=this.createVML("stroke");o.setAttribute("opacity",i["stroke-opacity"]),o.setAttribute("color",i.stroke),o.setAttribute("weight",i["stroke-width"]+"px"),a.appendChild(o);var l,n=!1;for(l in i)if(0===l.indexOf("shadow")){n=!0;break}if(i.shadowBlur){for(l in this._defaultStyle)i[l]||(i[l]=this._defaultStyle[l]);var h=1,c=.4;h+=i.shadowBlur/20,c-=i.shadowBlur/20;var d=this.createVML("shadow");d.type="perspective",d.on="True",d.color=i.shadowColor,d.offset=i.shadowOffsetX+"pt "+i.shadowOffsetY+"pt",d.opacity=c,d.matrix=h+",,,"+h+",0,0",a.appendChild(d)}this._canvas.appendChild(a),this._plugEventListeners(a,this.reportHTMLEvent,s)},_drawPathVML:function(t,e){for(var i="",s=t.length,a=0;s>a;a++){var r=t[a];i+=r[0]+"px,"+r[1]+"px",s-1>a&&(i+=",")}var o=this.createVML("polyline");if(o.style.position="absolute",o.style.cursor="pointer",o.points=i,$isDefined(e.fill)&&"none"!=e.fill){var l=this.createVML("fill");l.opacity=e["fill-opacity"],l.color=e.fill,o.appendChild(l),o.filled="True"}else o.filled="False";var n=this.createVML("stroke");$isDefined(e.stroke)&&"none"!=e.stroke?(n.opacity=e["stroke-opacity"],n.color=e.stroke,n.weight=e["stroke-width"]+"px",n.on="True",$isDefined(e["stroke-linejoin"])&&(n.joinstyle=e["stroke-linejoin"]),$isDefined(e["stroke-dasharray"])&&(n.dashstyle=e["stroke-dasharray"])):n.on="False",o.appendChild(n),this._canvas.appendChild(o)},_drawArrowVML:function(t,e,i){var s,a,r,o,l,n,h,c,d,p;if(p=t.length,o=i.type,delete i.type,$isDefined(o)?1==o?(s=Math.PI/4,a=.9*e["stroke-width"]):2==o?(s=Math.PI/4,a=1.5*e["stroke-width"]):3==o&&(s=Math.PI/2.7,a=1.1*e["stroke-width"]):(s=Math.PI/4,a=1.5*e["stroke-width"]),this._drawPathVML(t,e),h=[[t[p-1][0],t[p-1][1]],[t[p-2][0],t[p-2][1]]],t[p-1][0]!=t[p-2][0]||t[p-1][1]!=t[p-2][1]){l=this._droite(h[0],h[1]),n=this._point(l,h[0],h[1],a),c=this._rotate(h[0],n,Math.PI/2),d=this._rotate(h[0],n,-Math.PI/2),t=[c,d],r=this._heightArrow(a,s);var f=this._rotate(h[0],this._point(l,h[0],h[1],r),Math.PI);isNaN(f[0])||isNaN(f[1])||($isDefined(o)&&1!=o&&2!=o?3==o&&(i.fill="none",this._drawPathVML([[t[0][0],t[0][1]],[f[0],f[1]],[t[1][0],t[1][1]]],i)):(i.stroke=i.fill,this._drawPathVML([[h[0][0],h[0][1]],[t[0][0],t[0][1]],[f[0],f[1]],[t[1][0],t[1][1]],[h[0][0],h[0][1]]],i)))}},_clearContainerVML:function(){for(;this._canvas.firstChild;)this._canvas.removeChild(this._canvas.firstChild)}};